<!DOCTYPE html>
<html>
<head>
    <title>PPT Translate</title>
</head>
<body>
    <h1>Upload a PPT to Translate</h1>
    <form id="pptForm" enctype="multipart/form-data">
        <input type="file" name="ppt_file" id="ppt_file" accept=".pptx" required>
        <button type="submit">Translate</button>
    </form>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const pptForm = document.getElementById("pptForm");

            pptForm.addEventListener("submit", function(event) {
                event.preventDefault();

                const formData = new FormData(pptForm);

                fetch('http://localhost:8000/ppt-translate/', {  // 이 부분의 URL을 확인하세요
                    method: 'POST',
                    body: formData,
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.blob(); // Assuming the translated PPT is returned as a blob
                })
                .then(blob => {
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.style.display = 'none';
                    a.href = url;
                    a.download = 'translated.pptx';
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Failed to translate the PPT. Please try again.');
                });
            });
        });
    </script>
</body>
</html>
